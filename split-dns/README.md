### **OTUS — Administrator Linux. Professional.**  
#### **Домашнее задание №24 — Настраиваем split-DNS**

**Цель:**  
Создать домашнюю сетевую лабораторию. Изучить основы DNS и реализовать split-DNS на базе BIND.

---

#### **Задание:**

1. Взять стенд: https://github.com/erlong15/vagrant-bind;
2. Добавить ещё один сервер `client2`;
3. В зоне `dns.lab`:
   - создать `web1` → IP клиента 1;
   - создать `web2` → IP клиента 2;
4. Создать зону `newdns.lab`:
   - запись `www` → оба клиента;
5. Настроить split-DNS:
   - `client1` видит обе зоны, но в `dns.lab` только `web1`;
   - `client2` видит только `dns.lab`, но с `web2`.

---

#### **Ход выполнения**

1. **Подготовка стенда:**
   - Использован стенд с GitHub;
   - Добавлен `client2`;
   - Настройка автоматизирована через Ansible;
   - Проверка вручную:
     ```
     $ ansible --version
     ```

2. **Настройка BIND-сервера:**
   - Установлен `bind9`;
   - Настроены две зоны:
     - `dns.lab`;
     - `newdns.lab`.

3. **Настройка зоны `dns.lab`:**
   - Добавлены записи:
     ```
     web1 IN A 192.168.50.10   ; client1
     web2 IN A 192.168.50.11   ; client2
     ```

4. **Настройка зоны `newdns.lab`:**
   - Одна запись:
     ```
     www IN A 192.168.50.10
     www IN A 192.168.50.11
     ```

5. **Настройка split-DNS:**
   - Использована директива `view` в `named.conf`;
   - Для `client1`:
     - разрешён доступ к обеим зонам;
     - `dns.lab` возвращает только `web1`;
   - Для `client2`:
     - доступ только к `dns.lab`;
     - возвращается только `web2`.

6. **Проверка работы:**
   - На `client1`:
     ```
     dig @192.168.50.15 web1.dns.lab
     dig @192.168.50.15 web2.dns.lab ; NXDOMAIN
     dig @192.168.50.15 www.newdns.lab
     ```
   - На `client2`:
     ```
     dig @192.168.50.15 web2.dns.lab
     dig @192.168.50.15 www.newdns.lab ; REFUSED
     ```

---

#### **Вывод**

В результате:
- реализовано разделение зон с использованием механизма split-DNS;
- клиенты видят разные представления зоны в зависимости от IP;
- все проверки через `dig` соответствуют требованиям;
- настройка выполнена вручную и через Ansible.
