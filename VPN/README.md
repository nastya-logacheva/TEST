### **OTUS — Administrator Linux. Professional.**  
#### **Домашнее задание №23 — VPN**

**Цель:**  
Создать домашнюю сетевую лабораторию. Научиться настраивать VPN-сервер в Linux-based системах.

---

#### **Задание:**

1. Настроить VPN между двумя ВМ в режимах tun и tap;
2. Замерить скорость в каждом режиме, сделать вывод;
3. Настроить RAS-сервер (OpenVPN) с клиентскими сертификатами;
4. Проверить подключение с локальной машины на ВМ.

---

#### **Ход выполнения**

1. **Настройка стенда:**
   - Использован Vagrant и Ansible;
   - Две машины: `vpn-server` и `vpn-client`;
   - Использована методичка:  
     [Методичка по VPN](https://docs.google.com/document/d/1tJjZQzVccj0UoRlVLa-E-uxQtQDOCuW_sAk2nluiFo4/edit)

2. **OpenVPN в режиме TAP:**
   - Интерфейс `tap0` на обеих машинах;
   - Подсеть: `10.10.10.0/24`;
   - MTU: 1500;
   - Настроено соединение через конфиги и Ansible;
   - Проверка подключения через `ping` и `iperf3`.

3. **OpenVPN в режиме TUN:**
   - Интерфейс `tun0`;
   - Подсеть: `10.20.20.0/30`;
   - MTU: 1500;
   - Соединение через тот же сервер, с другими конфигами;
   - Скорость измерена через `iperf3`.

4. **Сравнение производительности:**
   - TAP показывает меньшую производительность, но поддерживает широковещательные пакеты (BROADCAST);
   - TUN работает быстрее и эффективнее, но не подходит для всего L2-трафика;
   - Пример вывода `iperf3`:
     ```
     TAP: ~85 Mbits/sec
     TUN: ~120 Mbits/sec
     ```

5. **Настройка OpenVPN RAS-сервера:**
   - Сервер принимает подключения по UDP 1194;
   - Созданы клиентские сертификаты через `easy-rsa`;
   - Настроен файл `client.ovpn`;
   - Подключение протестировано с локального хоста:
     ```
     openvpn --config client.ovpn
     ```

6. **Проверка связности:**
   - После подключения: клиент получает IP и доступ к сети VPN;
   - Сервер видит активное соединение:
     ```
     status.log, ifconfig, log
     ```

---

#### **Вывод**

В результате:
- VPN между двумя ВМ настроен в режимах tap и tun;
- Замерена и сравнена производительность;
- Реализован RAS OpenVPN с сертификатами;
- Проверено подключение с локального клиента;
- Настройка автоматизирована с помощью Ansible.
